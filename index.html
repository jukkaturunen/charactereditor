<!DOCTYPE html>
<html>
<head>
<title>World of Darkness Character Sheet</title>
<style>
  body {
    font-family: sans-serif;
    background-color: #f0f0f0;
  }
  .sheet {
    background-color: white;
    padding: 20px;
    margin: 20px;
    border: 1px solid black;
    width: 800px;
  }
  .header {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 10px;
    margin-bottom: 20px;
  }
  .header-item {
    display: grid;
    grid-template-columns: 100px 1fr;
  }
  .attributes, .skills, .other-traits {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 20px;
    margin-bottom: 20px;
  }
  .category {
    border: 1px solid #ccc;
    padding: 10px;
  }
  .category h3 {
    margin-top: 0;
    text-align: center;
  }
  .item {
    display: grid;
    grid-template-columns: 120px 1fr;
    margin-bottom: 5px;
    align-items: center;
  }
  .dots {
    display: flex;
    margin-bottom: 5px;
  }
  .dot {
    width: 15px;
    height: 15px;
    border: 1px solid black;
    border-radius: 50%;
    margin-right: 3px;
    cursor: pointer;
  }
  .dot.filled {
    background-color: black;
  }
  .specialty-box {
    width: 10px;
    height: 10px;
    border: 1px solid black;
    margin-right: 5px;
    display: inline-block;
    cursor: pointer;
  }
  .specialty-box.filled {
    background-color: black;
  }
  .boxes {
    display: flex;
    margin-bottom: 5px;
  }
  .box {
    width: 15px;
    height: 15px;
    border: 1px solid black;
    margin-right: 3px;
    cursor: pointer;
  }
  .box.filled {
    background-color: black;
  }
</style>
</head>
<body>

<div class="sheet">
  <h1>Character Sheet</h1>
  <div class="header">
    <div class="header-item"><span>Name:</span> <span id="name"></span></div>
    <div class="header-item"><span>Age:</span> <span id="age"></span></div>
    <div class="header-item"><span>Player:</span> <span id="player"></span></div>
    <div class="header-item"><span>Concept:</span> <span id="concept"></span></div>
    <div class="header-item"><span>Virtue:</span> <span id="virtue"></span></div>
    <div class="header-item"><span>Vice:</span> <span id="vice"></span></div>
    <div class="header-item"><span>Chronicle:</span> <span id="chronicle"></span></div>
    <div class="header-item"><span>Faction:</span> <span id="faction"></span></div>
    <div class="header-item"><span>Group Name:</span> <span id="group_name"></span></div>
  </div>

  <h2>Attributes</h2>
  <div class="attributes">
    <div class="category" id="mental-attributes"><h3>Mental</h3></div>
    <div class="category" id="physical-attributes"><h3>Physical</h3></div>
    <div class="category" id="social-attributes"><h3>Social</h3></div>
  </div>

  <h2>Skills</h2>
  <div class="skills">
    <div class="category" id="mental-skills"><h3>Mental</h3></div>
    <div class="category" id="physical-skills"><h3>Physical</h3></div>
    <div class="category" id="social-skills"><h3>Social</h3></div>
  </div>

  <h2>Other Traits</h2>
  <div class="other-traits">
    <div class="category" id="health"></div>
    <div class="category" id="willpower"></div>
    <div class="category" id="integrity"></div>
  </div>
</div>

<script>
  const characterData = {
  "character": {
    "name": "Pax Fuller",
    "age": "20",
    "player": "Jukka",
    "concept": "Driven young man looking for his disappeared sister",
    "virtue": "Humble",
    "vice": "Hasty",
    "chronicle": "Lifting the Veil",
    "faction": "",
    "group_name": "",
    "attributes": {
      "mental": {
        "intelligence": 4,
        "wits": 2,
        "resolve": 2
      },
      "physical": {
        "strength": 2,
        "dexterity": 2,
        "stamina": 2
      },
      "social": {
        "presence": 3,
        "manipulation": 1,
        "composure": 3
      }
    },
    "skills": {
      "mental": {
        "academics": 4,
        "computer": 2,
        "crafts": 0,
        "investigation": 3,
        "medicine": 0,
        "occult": 1,
        "politics": 0,
        "science": 1
      },
      "physical": {
        "athletics": 1,
        "brawl": 0,
        "drive": 1,
        "firearms": 1,
        "larceny": 1,
        "stealth": 0,
        "survival": 0,
        "weaponry": 0
      },
      "social": {
        "animal_ken": 0,
        "empathy": 3,
        "expression": 0,
        "intimidation": 0,
        "persuasion": 2,
        "socialize": 1,
        "streetwise": 1,
        "subterfuge": 0
      }
    },
    "specialties": {
      "academics": "history",
      "investigation": "crime scene investigation",
      "empathy": "detecting lies"
    },
    "merits": {
      "Eidetic Memory": {
        "dots": [
          2
        ],
        "effect": "Automatically recalls details. +2 on Intelligence + Composure to recall facts."
      },
      "Contacts": {
        "dots": 3,
        "targets": [
          "the lone gunmen",
          "occult",
          "investigation",
          "streetwise"
        ],
        "prerequisites": [],
        "effect": "Each dot gives access to a field of information. Roll Manipulation + Social Skill to gain intel. Can reveal other characters’ Merits or Conditions."
      },
      "Resources": {
        "dots": 2,
        "prerequisites": [],
        "effect": "Disposable income. Each dot increases purchasing power. Items up to Resources can be bought each chapter without problem."
      }
    },
    "health": {
      "max": 7,
      "damage": {
        "bashing": 0,
        "lethal": 0,
        "aggravated": 0
      }
    },
    "willpower": {
      "max": 5,
      "current": 2
    },
    "integrity": 7,
    "size": 5,
    "speed": 9,
    "defense": 2,
    "armor": 0,
    "initiative_mod": 5,
    "beats": 2,
    "experiences": {
      "total": 2,
      "gained from": {},
      "spent on": {"integrity+1":2, "wits+1":4,"occult+1":2,"larceny+1":2}
    },
    "conditions": [],
    "aspirations": [],
    "equipment": [],
    "weapons": {
      "none": {
        "dmg": 0,
        "range": {
          "short": 0,
          "medium": 0,
          "long": 0
        },
        "clip": 0,
        "init": 0,
        "str": 0,
        "size": 0
      }
    },
    "vehicles": {
      "none": {
        "durability": 0,
        "structure": 0,
        "size": 0,
        "acceleration": 0,
        "safe speed": 0,
        "max speed": 0,
        "handling": 0
      }
    },
    "breaking_points": ["bonus tähän"],
    "history": [],
    "goals": [],
    "description": {
      "age": "",
      "date_of_birth": "",
      "hair": "",
      "eyes": "",
      "race": "",
      "nationality": "",
      "height": "",
      "weight": "",
      "sex": "Male",
      "distinguishing_characteristics": ""
    }
  }
};

  function renderDots(category, subcategory, name, value, maxDots = 5) {
    let dotsHtml = '<div class="dots">';
    for (let i = 0; i < maxDots; i++) {
      const newValue = (i + 1 === value) ? 0 : i + 1;
      dotsHtml += `<div class="dot ${i < value ? 'filled' : ''}" onclick="updateValue('${category}', '${subcategory}', '${name}', ${newValue})"></div>`;
    }
    dotsHtml += '</div>';
    return dotsHtml;
  }

  function renderBoxes(category, name, value, maxBoxes = 10) {
    let boxesHtml = '<div class="boxes">';
    for (let i = 0; i < maxBoxes; i++) {
      const newValue = (i + 1 === value) ? 0 : i + 1;
      boxesHtml += `<div class="box ${i < value ? 'filled' : ''}" onclick="updateValue('${category}', '', '${name}', ${newValue})"></div>`;
    }
    boxesHtml += '</div>';
    return boxesHtml;
  }

  function updateValue(category, subcategory, name, newValue) {
    if (subcategory) {
      characterData.character[category][subcategory][name] = newValue;
    } else if (name) {
      characterData.character[category][name] = newValue;
    } else {
      characterData.character[category] = newValue;
    }
    render();
  }

  function toggleSpecialty(skillName) {
    if (characterData.character.specialties.hasOwnProperty(skillName)) {
      delete characterData.character.specialties[skillName];
    } else {
      characterData.character.specialties[skillName] = "";
    }
    render();
  }

  function populateSheet(data) {
    const character = data.character;

    // Header
    document.getElementById('name').textContent = character.name;
    document.getElementById('age').textContent = character.age;
    document.getElementById('player').textContent = character.player;
    document.getElementById('concept').textContent = character.concept;
    document.getElementById('virtue').textContent = character.virtue;
    document.getElementById('vice').textContent = character.vice;
    document.getElementById('chronicle').textContent = character.chronicle;
    document.getElementById('faction').textContent = character.faction;
    document.getElementById('group_name').textContent = character.group_name;

    // Attributes
    const mentalAttributes = document.getElementById('mental-attributes');
    mentalAttributes.innerHTML = '<h3>Mental</h3>';
    for (const attr in character.attributes.mental) {
      mentalAttributes.innerHTML += `<div class="item"><span>${attr}</span>${renderDots('attributes', 'mental', attr, character.attributes.mental[attr])}</div>`;
    }
    const physicalAttributes = document.getElementById('physical-attributes');
    physicalAttributes.innerHTML = '<h3>Physical</h3>';
    for (const attr in character.attributes.physical) {
      physicalAttributes.innerHTML += `<div class="item"><span>${attr}</span>${renderDots('attributes', 'physical', attr, character.attributes.physical[attr])}</div>`;
    }
    const socialAttributes = document.getElementById('social-attributes');
    socialAttributes.innerHTML = '<h3>Social</h3>';
    for (const attr in character.attributes.social) {
      socialAttributes.innerHTML += `<div class="item"><span>${attr}</span>${renderDots('attributes', 'social', attr, character.attributes.social[attr])}</div>`;
    }

    // Skills
    const mentalSkills = document.getElementById('mental-skills');
    mentalSkills.innerHTML = '<h3>Mental</h3>';
    for (const skill in character.skills.mental) {
      const hasSpecialty = character.specialties.hasOwnProperty(skill);
      mentalSkills.innerHTML += `<div class="item"><span><div class="specialty-box ${hasSpecialty ? 'filled' : ''}" onclick="toggleSpecialty('${skill}')"></div>${skill}</span>${renderDots('skills', 'mental', skill, character.skills.mental[skill])}</div>`;
    }
    const physicalSkills = document.getElementById('physical-skills');
    physicalSkills.innerHTML = '<h3>Physical</h3>';
    for (const skill in character.skills.physical) {
      const hasSpecialty = character.specialties.hasOwnProperty(skill);
      physicalSkills.innerHTML += `<div class="item"><span><div class="specialty-box ${hasSpecialty ? 'filled' : ''}" onclick="toggleSpecialty('${skill}')"></div>${skill}</span>${renderDots('skills', 'physical', skill, character.skills.physical[skill])}</div>`;
    }
    const socialSkills = document.getElementById('social-skills');
    socialSkills.innerHTML = '<h3>Social</h3>';
    for (const skill in character.skills.social) {
      const hasSpecialty = character.specialties.hasOwnProperty(skill);
      socialSkills.innerHTML += `<div class="item"><span><div class="specialty-box ${hasSpecialty ? 'filled' : ''}" onclick="toggleSpecialty('${skill}')"></div>${skill}</span>${renderDots('skills', 'social', skill, character.skills.social[skill])}</div>`;
    }

    // Other Traits
    const healthEl = document.getElementById('health');
    healthEl.innerHTML = '<h3>Health</h3>';
    healthEl.innerHTML += renderDots('health', '', 'max', character.health.max, 10);
    let emptyBoxes = '<div class="boxes">';
    for(let i=0; i<10; i++) {
        emptyBoxes += '<div class="box"></div>';
    }
    emptyBoxes += '</div>';
    healthEl.innerHTML += emptyBoxes;

    const willpowerEl = document.getElementById('willpower');
    willpowerEl.innerHTML = '<h3>Willpower</h3>';
    willpowerEl.innerHTML += renderDots('willpower', '', 'max', character.willpower.max, 10);
    willpowerEl.innerHTML += renderBoxes('willpower', 'current', character.willpower.current, 10);

    const integrityEl = document.getElementById('integrity');
    integrityEl.innerHTML = '<h3>Integrity</h3>';
    integrityEl.innerHTML += renderDots('integrity', '', '', character.integrity, 10);
  }

  function render() {
    populateSheet(characterData);
  }

  render();
</script>

</body>
</html>